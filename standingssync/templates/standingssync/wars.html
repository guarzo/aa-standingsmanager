{% extends 'standingssync/_base.html' %}
{% load i18n %}
{% load humanize %}
{% load standingssync %}

{% block details %}
    <div class="panel panel-default">
        <div class="panel-heading" style="display:flex;">
            <h3 class="panel-title">{{ alliance }} ({{ war_count }})</h3>
        </div>
        <div class="panel-body">
            <div role="tabpanel" class="tab-pane">
                <table class="table table-striped table-width-fix" id="tab-active-wars">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Start</th>
                            <th>Aggressor</th>
                            <th>Defender</th>
                            <th>Allies</th>
                            <th>Finish</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for war in wars %}
                            <tr>
                                <td>
                                    {% if not war.is_active %}
                                        <i class="fas fa-pause text-info"></i>
                                    {% else %}
                                        <i class="fas fa-play text-danger"></i>
                                    {% endif %}
                                </td>
                                <td data-sort="{{ war.started.isoformat }}" class="text-nowrap">
                                    <span title="{{ war.started|date:DATEFORMAT }}">
                                        {{ war.started|naturaltime }}
                                    </span>
                                </td>
                                <td data-sort="{{ war.aggressor }}">
                                    {% war_participant war.aggressor %}
                                </td>
                                <td data-sort="{{ war.defender }}">
                                    {% war_participant war.defender %}
                                </td>
                                <td>
                                    {% for ally in war.allies %}
                                        {% war_participant ally %}<br>
                                    {% empty %}
                                        -
                                    {% endfor %}
                                </td>
                                <td data-sort="{{ war.finished.isoformat }}" class="text-nowrap">
                                    {% if war.finished %}
                                        <span title="{{ war.finished|date:DATEFORMAT }}">
                                            {{ war.finished|naturaltime }}
                                        </span>
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <p>
        <i class="fas fa-play text-danger"></i>&nbsp;&nbsp;Active war
        &nbsp;&nbsp;
        <i class="fas fa-pause text-info"></i>&nbsp;&nbsp;Inactive war
    </p>
{% endblock %}

{% block extra_javascript %}
    {% include 'bundles/datatables-js.html' %}

    <script type="application/javascript">
        $(document).ready(function () {
            $('#tab-active-wars').DataTable({
                paging: false,
                info: false,
                order: [ [1, "desc"] ],
                columnDefs: [
                    { "sortable": false, "targets": [ 0, 4 ] },
                ],
            });
        });
    </script>
{% endblock %}

{% block extra_css %}
    {{ block.super }}
    {% include 'bundles/datatables-css.html' %}
{% endblock %}
